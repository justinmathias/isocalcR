---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# isocalcR

<!-- badges: start -->
#   [![R-CMD-check](https://github.com/justinmathias/isocalcR/workflows/R-CMD-check/badge.svg)](https://github.com/justinmathias/isocalcR/actions) [![codecov](https://codecov.io/gh/justinmathias/isocalcR/branch/main/graph/badge.svg?token=W72B141APE)](https://codecov.io/gh/justinmathias/isocalcR) [![metacran downloads](https://cranlogs.r-pkg.org/badges/isocalcR)](https://cran.r-project.org/package=isocalcR) [![license](https://img.shields.io/badge/license-GPL--3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0.en.html) [![CRAN_Status_Badge](https://www.r-pkg.org/badges/version/isocalcR)](https://cran.r-project.org/package=isocalcR)
<!-- badges: end -->


The goal of `isocalcR` is to provide a suite of user-friendly, open source functions for commonly performed calculations when working with stable isotope data. A major goal of `isocalcR` is to help eliminate errors associated with data compilation necessary for many standard calculations, as well as to provide the scientific community with a reliable, easily accessible resource for reproducible work. Part of this effort includes best practices of data usage, as the user is not required to download atmospheric CO~2~ or atmospheric δ^13^CO~2~ data for the workhorse calculations, but instead relies on published, peer-reviewed, and recommended publicly available data (Belmecheri and Lavergne, 2020). `isocalcR` is not meant to replace an understanding of the underlying physiological mechanisms related to these calculations, but instead to streamline the process. At present, calculations for years 0 C.E. - 2021 C.E. are stable and will work with all functions, with 2022 being added at the end of the year.

## Installation

You can install the released version of isocalcR from [CRAN](https://CRAN.R-project.org) with:

``` r
install.packages("isocalcR")
```

And the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("justinmathias/isocalcR")
```

## Functionality

|`isocalcR` Function  | Description                                                                                                    |
|-------------------- |----------------------------------------------------------------------------------------------------------------|
|`d13C.to.D13C`       | Calculate leaf carbon isotope discrimination (∆^13^C) given plant tissue δ^13^C signature (‰)                     |
|`d13C.to.Ci`         | Calculate leaf intercellular CO~2~ concentration (ppm) given plant tissue δ^13^C signature (‰)                      |
|`d13C.to.CiCa`       | Calculate the ratio of leaf intercellular CO~2~ to atmospheric CO~2~ concentration (ppm) given plant tissue δ^13^C signature (‰)  |
|`d13C.to.diffCaCi`   | Calculate the difference between atmospheric CO~2~ concentration (ppm) and leaf intercellular CO~2~ concentration (ppm) given plant tissue δ^13^C signature (‰)  |
|`d13C.to.iWUE`       | Calculate leaf intrinsic water use efficiency (µmol CO~2~ mol H~2~O^-1^) given plant tissue δ^13^C signature (‰)  |
|`custom.calc`        | Calculate ∆^13^C, Ci, CiCa, diffCaCi, or iWUE given plant tissue δ^13^C signature (‰)  |



<br>

## Examples

Calculate leaf intrinsic water use efficiency from leaf δ^13^C:

```{r example}
library(isocalcR) #Load the package

#Calculate iWUE from leaf organic material with a δ13C signature of -27 ‰ for the year 2015, 300 meters above sea level at 25°C.
d13C.to.iWUE(d13C.plant = -27, 
             year = 2015, 
             elevation = 300, 
             temp = 25) 

#Use custom.calc to calculate iWUE from the same leaf sample as above.
custom.calc(d13C.plant = -27,
            d13C.atm = -8.44,
            outvar = "iWUE",
            Ca = 399.62,
            elevation = 300,
            temp = 25)



```

Data for atmospheric CO~2~ and atmospheric δ^13^CO~2~ for the period 0 C.E. to 2021 C.E. can be loaded and viewed.  Data are from Belmecheri and Lavergne (2020).

```{r CO2data}
data(CO2data) #Load CO2data into your environment

head(CO2data) #View initial CO2data observations

tail(CO2data) #View most recent CO2data observations
```

## Literature cited

Badeck, F.-W., Tcherkez, G., Nogués, S., Piel, C. & Ghashghaie, J. (2005). Post-photosynthetic fractionation of stable carbon isotopes between plant organs—a widespread phenomenon. Rapid Commun. Mass Spectrom., 19, 1381–1391.

Belmecheri, S. & Lavergne, A. (2020). Compiled records of atmospheric CO~2~ concentrations and stable carbon isotopes to reconstruct climate and derive plant ecophysiological indices from tree rings. Dendrochronologia, 63, 125748.

Bernacchi, C.J., Singsaas, E.L., Pimentel, C., Portis Jr, A.R. & Long, S.P. (2001). Improved temperature response functions for models of Rubisco-limited photosynthesis. Plant, Cell Environ., 24, 253–259.

Craig, H. (1953). The geochemistry of the stable carbon isotopes. Geochim. Cosmochim. Acta, 3, 53–92.

Cernusak, L. A. & Ubierna, N. Carbon Isotope Effects in Relation to CO~2~ Assimilation by Tree Canopies. in Stable Isotopes in Tree Rings: inferring physiological, climatic, and environmental responses 291–310 (2022). doi:10.1007/978-3-030-92698-4_9.

Davies, J.A. & Allen, C.D. (1973). Equilibrium, Potential and Actual Evaporation from Cropped Surfaces in Southern Ontario. J. Appl. Meteorol., 12, 649–657.

Farquhar, G., O’Leary, M. & Berry, J. (1982). On the relationship between carbon isotope discrimination and the intercellular carbon dioxide concentration in leaves. Aust. J. Plant Physiol., 9, 121–137.

Frank, D.C., Poulter, B., Saurer, M., Esper, J., Huntingford, C., Helle, G., et al. (2015). Water-use efficiency and transpiration across European forests during the Anthropocene. Nat. Clim. Chang., 5, 579–583.

Gong, X. Y. et al. Overestimated gains in water‐use efficiency by global forests. Glob. Chang. Biol. 1–12 (2022) doi:10.1111/gcb.16221.

Lavergne, A. et al. Global decadal variability of plant carbon isotope discrimination and its link to gross primary production. Glob. Chang. Biol. 28, 524–541 (2022).

Ma, W. T. et al. Accounting for mesophyll conductance substantially improves ^13^C-based estimates of intrinsic water-use efficiency. New Phytol. 229, 1326–1338 (2021).

Tsilingiris, P.T. (2008). Thermophysical and transport properties of humid air at temperature range between 0 and 100°C. Energy Convers. Manag., 49, 1098–1110.

Ubierna, N. & Farquhar, G.D. (2014). Advances in measurements and models of photosynthetic carbon isotope discrimination in C~3~ plants. Plant. Cell Environ., 37, 1494–1498.

